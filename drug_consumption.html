<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>药剂消耗核算</title>
<link href="//unpkg.com/layui@2.9.13/dist/css/layui.css" rel="stylesheet">
<style>
body{padding:10px}
table{width:100%;border-collapse:collapse}
td,th{border:1px solid #ccc;padding:4px;text-align:center}

/* 普通数据输入框（加大，支持 6529.99） */
.input-big{
    width:100%;
    box-sizing:border-box;
    font-size:18px;
    height:40px;
    padding:6px 8px;
}

/* 浓度输入框（刻意做小） */
.input-small{
    width:120px;
    font-size:14px;
    height:28px;
    padding:2px 4px;
}

textarea{
    width:100%;
    box-sizing:border-box;
    min-height:160px;
    font-size:15px;
}

.section{margin-bottom:30px}
.footer{margin-top:20px;color:#666;font-size:12px}
</style>
</head>
<body>

<h1>药剂消耗核算</h1>

<p>浓度（%）：</p>
<table>
<tr><th></th><th>浓度</th></tr>
<tr><td>一期混凝</td><td><input class="input-small" id="c_p1_m"></td></tr>
<tr><td>一期助凝</td><td><input class="input-small" id="c_p1_a"></td></tr>
<tr><td>二期混凝</td><td><input class="input-small" id="c_p2_m"></td></tr>
<tr><td>二期助凝</td><td><input class="input-small" id="c_p2_a"></td></tr>
</table>

<div class="section"><h2>一期 · 混凝</h2>
<table>
<tr><th>时间</th><th>1</th><th>2</th><th>3</th><th>4</th><th>一二系消耗</th><th>三四系消耗</th></tr>
<tr><td>8</td>
<td><input class="input-big" id="p1m18"></td>
<td><input class="input-big" id="p1m28"></td>
<td><input class="input-big" id="p1m38"></td>
<td><input class="input-big" id="p1m48"></td>
<td rowspan="2" id="o_p1_m_12"></td>
<td rowspan="2" id="o_p1_m_34"></td></tr>
<tr><td>17</td>
<td><input class="input-big" id="p1m117"></td>
<td><input class="input-big" id="p1m217"></td>
<td><input class="input-big" id="p1m317"></td>
<td><input class="input-big" id="p1m417"></td></tr>
</table></div>

<div class="section"><h2>一期 · 助凝</h2>
<table>
<tr><th>时间</th><th>1</th><th>2</th><th>3</th><th>4</th><th>一二系消耗</th><th>三四系消耗</th></tr>
<tr><td>8</td>
<td><input class="input-big" id="p1a18"></td>
<td><input class="input-big" id="p1a28"></td>
<td><input class="input-big" id="p1a38"></td>
<td><input class="input-big" id="p1a48"></td>
<td rowspan="2" id="o_p1_a_12"></td>
<td rowspan="2" id="o_p1_a_34"></td></tr>
<tr><td>17</td>
<td><input class="input-big" id="p1a117"></td>
<td><input class="input-big" id="p1a217"></td>
<td><input class="input-big" id="p1a317"></td>
<td><input class="input-big" id="p1a417"></td></tr>
</table></div>

<div class="section"><h2>二期 · 混凝</h2>
<table>
<tr><th>时间</th><th>5-1</th><th>5-2</th><th>6-1</th><th>6-2</th><th>5系消耗</th><th>6系消耗</th></tr>
<tr><td>8</td>
<td><input class="input-big" id="p2m518"></td>
<td><input class="input-big" id="p2m528"></td>
<td><input class="input-big" id="p2m618"></td>
<td><input class="input-big" id="p2m628"></td>
<td rowspan="2" id="o_p2_m_5"></td>
<td rowspan="2" id="o_p2_m_6"></td></tr>
<tr><td>17</td>
<td><input class="input-big" id="p2m5117"></td>
<td><input class="input-big" id="p2m5217"></td>
<td><input class="input-big" id="p2m6117"></td>
<td><input class="input-big" id="p2m6217"></td></tr>
</table></div>

<div class="section"><h2>二期 · 助凝</h2>
<table>
<tr><th>时间</th><th>5-1</th><th>5-2</th><th>6-1</th><th>6-2</th><th>5系消耗</th><th>6系消耗</th></tr>
<tr><td>8</td>
<td><input class="input-big" id="p2a518"></td>
<td><input class="input-big" id="p2a528"></td>
<td><input class="input-big" id="p2a618"></td>
<td><input class="input-big" id="p2a628"></td>
<td rowspan="2" id="o_p2_a_5"></td>
<td rowspan="2" id="o_p2_a_6"></td></tr>
<tr><td>17</td>
<td><input class="input-big" id="p2a5117"></td>
<td><input class="input-big" id="p2a5217"></td>
<td><input class="input-big" id="p2a6117"></td>
<td><input class="input-big" id="p2a6217"></td></tr>
</table></div>

<h2>自动生成班报 / 日报</h2>
<textarea id="report"></textarea>

<div class="footer">计算版本：V1.1.2-输入框区分尺寸</div>

<script>
function n(id){return parseFloat(document.getElementById(id).value)||0}

function calc(){
 const p1m12=(n('p1m117')-n('p1m18')+n('p1m217')-n('p1m28'))*n('c_p1_m')/100*1000;
 const p1m34=(n('p1m317')-n('p1m38')+n('p1m417')-n('p1m48'))*n('c_p1_m')/100*1000;

 const p1a12=(n('p1a117')-n('p1a18')+n('p1a217')-n('p1a28'))*n('c_p1_a')/100*1000;
 const p1a34=(n('p1a317')-n('p1a38')+n('p1a417')-n('p1a48'))*n('c_p1_a')/100*1000;

 const p2m5=(n('p2m5117')-n('p2m518')+n('p2m5217')-n('p2m528'))*n('c_p2_m')/100*1000;
 const p2m6=(n('p2m6117')-n('p2m618')+n('p2m6217')-n('p2m628'))*n('c_p2_m')/100*1000;

 const p2a5=(n('p2a5117')-n('p2a518')+n('p2a5217')-n('p2a528'))*n('c_p2_a')/100*1000;
 const p2a6=(n('p2a6117')-n('p2a618')+n('p2a6217')-n('p2a628'))*n('c_p2_a')/100*1000;

 document.getElementById('o_p1_m_12').innerText=p1m12.toFixed(2);
 document.getElementById('o_p1_m_34').innerText=p1m34.toFixed(2);
 document.getElementById('o_p1_a_12').innerText=p1a12.toFixed(2);
 document.getElementById('o_p1_a_34').innerText=p1a34.toFixed(2);
 document.getElementById('o_p2_m_5').innerText=p2m5.toFixed(2);
 document.getElementById('o_p2_m_6').innerText=p2m6.toFixed(2);
 document.getElementById('o_p2_a_5').innerText=p2a5.toFixed(2);
 document.getElementById('o_p2_a_6').innerText=p2a6.toFixed(2);

 document.getElementById('report').value =
`药剂消耗日报
一期混凝：${p1m12.toFixed(2)} / ${p1m34.toFixed(2)}（合计：${(p1m12+p1m34).toFixed(2)}）
一期助凝：${p1a12.toFixed(2)} / ${p1a34.toFixed(2)}（合计：${(p1a12+p1a34).toFixed(2)}）
二期混凝：${p2m5.toFixed(2)} / ${p2m6.toFixed(2)}（合计：${(p2m5+p2m6).toFixed(2)}）
二期助凝：${p2a5.toFixed(2)} / ${p2a6.toFixed(2)}（合计：${(p2a5+p2a6).toFixed(2)}）`;
}

document.querySelectorAll('input').forEach(e=>e.addEventListener('input',calc));
calc();
</script>

</body>
</html>